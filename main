#!/usr/bin/python3
from Candidate import Candidate
from Employee import Employee
import datetime
import gspread
import smtplib
import ssl
import time
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart

today = int(datetime.datetime.now().strftime('%j'))
year = int(datetime.datetime.now().year)
test_email = 'dylan.doyle11@gmail.com'


def sheetconnect():
    try:
        from oauth2client.service_account import ServiceAccountCredentials
        scope = ['https://spreadsheets.google.com/feeds', 'https://www.googleapis.com/auth/drive']
        creds = ServiceAccountCredentials.from_json_keyfile_name('/home/pi/Desktop/Python/Bot/bot_cred.json', scope)
        client = gspread.authorize(creds)

        global sheet
        sheet = client.open("Candidate Tracker").sheet1
        # backup_sheet = client.open("Candidate Tracker Database").sheet1
    except:
        print('Failed to connect. Retrying in 10 seconds')
        time.sleep(10)
        pass

bot1 = Main()
sheetconnect()
bot1.run()
bot1.notifymaster()
exit()
